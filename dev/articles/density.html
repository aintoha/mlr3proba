<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Density Estimation in mlr3proba • mlr3proba</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<link href="../extra.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Density Estimation in mlr3proba">
<meta property="og:description" content="mlr3proba">
<meta property="og:image" content="https://mlr3proba.mlr-org.com/logo.svg">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a href="https://mlr-org.com"><img src="https://raw.githubusercontent.com/mlr-org/mlr3/master/man/figures/logo.png" id="hexlogo" alt="mlr-org"></a>
        <a class="navbar-brand" href="../index.html">mlr3proba <small>v0.1.4.9000</small></a>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/survival.html">Survival Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://mlr3book.mlr-org.com">
    <span class="fa fa fa fa-link"></span>
     
    mlr3book
  </a>
</li>
        <li>
  <a href="https://github.com/mlr-org/mlr3proba/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/">
    <span class="fa fa fa fa-comments"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/questions/tagged/mlr3">
    <span class="fab fa fab fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Density Estimation in mlr3proba</h1>
                        <h4 class="author">Nurul Ain Toha</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr3proba/blob/master/vignettes/density.Rmd"><code>vignettes/density.Rmd</code></a></small>
      <div class="hidden name"><code>density.Rmd</code></div>

    </div>

    
    
<p>This vignette is an introduction to performing density estimation in <strong>mlr3proba</strong>.</p>
<div id="a-very-quick-introduction-to-density-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#a-very-quick-introduction-to-density-estimation" class="anchor"></a>A very quick introduction to density estimation</h2>
<p>Density estimation is the learning task to find the unknown distribution from which an i.i.d. data set is generated. We interpret this broadly, with this distribution not necessarily being continuous (so may possess a mass not density). The conditional case, where a distribution is predicted conditional on covariates, is known as ‘probabilistic supervised regression’, and will be implemented in <strong>mlr3proba</strong> in the near-future. In <strong>mlr3proba</strong>, (unconditional) density estimation is viewed as an unsupervised task, whereas probabilistic supervised regression (or conditional density estimation) is a supervised task</p>
</div>
<div id="density-task" class="section level2">
<h2 class="hasAnchor">
<a href="#density-task" class="anchor"></a>Density Task</h2>
<p>Unconditional density estimation is an unsupervised method. Hence, <code>TaskDens</code> is an unsupervised task which inherits directly from <code>Task</code> unlike <code>TaskClassif</code> and <code>TaskRegr</code>. However, <code>TaskDens</code> still has a <code>target</code> and a <code>$truth</code> field defined by:</p>
<ul>
<li>
<code>target</code> - the variable for which to estimate density</li>
<li>
<code>truth</code> - the <code>target</code>. This is <em>not</em> the true density which is always unknown.</li>
</ul>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mlr3proba</span>); <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mlr3</span>)

<span class="no">task</span> <span class="kw">=</span> <span class="no">TaskDens</span>$<span class="fu">new</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"mpg"</span>, <span class="kw">backend</span> <span class="kw">=</span> <span class="kw pkg">datasets</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/r/datasets/mtcars.html">mtcars</a></span>, <span class="kw">target</span> <span class="kw">=</span> <span class="st">"mpg"</span>)

<span class="no">task</span>
<span class="co">#&gt; &lt;TaskDens:mpg&gt; (32 x 11)</span>
<span class="co">#&gt; * Target: mpg</span>
<span class="co">#&gt; * Properties: -</span>
<span class="co">#&gt; * Features (10):</span>
<span class="co">#&gt;   - dbl (10): am, carb, cyl, disp, drat, gear, hp, qsec, vs, wt</span>

<span class="no">task</span>$<span class="fu">truth</span>()[<span class="fl">1</span>:<span class="fl">10</span>]
<span class="co">#&gt;  [1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2</span></pre></body></html></div>
</div>
<div id="train-and-predict" class="section level2">
<h2 class="hasAnchor">
<a href="#train-and-predict" class="anchor"></a>Train and Predict</h2>
<p>Density learners have <code>train</code> and <code>predict</code> methods, though being unsupervised, ‘prediction’ is actually ‘estimation’. In training, a <a href="https://cran.r-project.org/package=distr6">distr6</a> object is created, <a href="https://alan-turing-institute.github.io/distr6/">see here</a> for full tutorials on how to access the <code>pdf</code>, <code>cdf</code>, and other important fields and methods. The predict method is simply a wrapper around <code>self$model$pdf</code> and if available <code>self$model$cdf</code>, i.e. evaluates the pdf/cdf at given points. Note that in prediction the points to evaluate the pdf and cdf are determined by the <code>target</code> column in the <code>TaskDens</code> object used for testing.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># create task and learner</span>

<span class="no">task_faithful</span> <span class="kw">=</span> <span class="no">TaskDens</span>$<span class="fu">new</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"eruptions"</span>, <span class="kw">backend</span> <span class="kw">=</span> <span class="kw pkg">datasets</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/r/datasets/faithful.html">faithful</a></span>,
                             <span class="kw">target</span> <span class="kw">=</span> <span class="st">"eruptions"</span>)
<span class="no">learner</span> <span class="kw">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">lrn</a></span>(<span class="st">"dens.spline"</span>)

<span class="co"># train/test split </span>

<span class="no">train_set</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="no">task_faithful</span>$<span class="no">nrow</span>, <span class="fl">0.8</span> * <span class="no">task_faithful</span>$<span class="no">nrow</span>)
<span class="no">test_set</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="no">task_faithful</span>$<span class="no">nrow</span>), <span class="no">train_set</span>)

<span class="co"># fitting KDE and model inspection</span>

<span class="no">learner</span>$<span class="fu">train</span>(<span class="no">task_faithful</span>, <span class="kw">row_ids</span> <span class="kw">=</span> <span class="no">train_set</span>)
<span class="no">learner</span>$<span class="no">model</span>
<span class="co">#&gt; splineDens</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="no">learner</span>$<span class="no">model</span>)
<span class="co">#&gt; [1] "Distribution" "R6"</span>

<span class="co"># make predictions for new data</span>

<span class="no">prediction</span> <span class="kw">=</span> <span class="no">learner</span>$<span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">task_faithful</span>, <span class="kw">row_ids</span> <span class="kw">=</span> <span class="no">test_set</span>)</pre></body></html></div>
<p>Every <code>PredictionDens</code> object can estimate:</p>
<ul>
<li>
<code>pdf</code> - probability density function</li>
</ul>
<p>Some learners can estimate:</p>
<ul>
<li>
<code>cdf</code> - cumulative distribution function</li>
</ul>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">prediction</span>
<span class="co">#&gt; &lt;PredictionDens&gt; for 55 observations:</span>
<span class="co">#&gt;     row_id truth        pdf       cdf</span>
<span class="co">#&gt;          3 3.333 0.06599954 0.3639503</span>
<span class="co">#&gt;          8 3.600 0.13666034 0.3892788</span>
<span class="co">#&gt;         11 1.833 0.50578997 0.0742322</span>
<span class="co">#&gt; ---                                  </span>
<span class="co">#&gt;        241 4.150 0.56150978 0.5805284</span>
<span class="co">#&gt;        242 2.350 0.17665005 0.3017866</span>
<span class="co">#&gt;        272 4.467 0.65884519 0.7745161</span>

<span class="co"># `pdf` is evaluated using the `log-loss`</span>

<span class="no">prediction</span>$<span class="fu">score</span>()
<span class="co">#&gt; dens.logloss </span>
<span class="co">#&gt;     1.033938</span></pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Raphael Sonabend, Franz Kiraly, Michel Lang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
